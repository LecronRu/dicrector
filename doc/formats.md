## Предустановленные форматы.

Все форматы кроме `ext`, рассчитаны на загрузку данных из текстовых файлов, содержащих строки правил в 
формате поиск=замена.
Строки начинающиеся с символа `$` содержат регистрозависимое правило поиска.
Строки начинающиеся с символа `#` содержат комментарий. Строки с правилом, также могут содержать комментарий 
отделенный от данных пробелом и символом `#`. Из-за чего невозможно использование этого символа в самих правилах.

*Внимание*: Внутренний символ ударения — \` (обратный апостроф) после ударной гласной. Другие символы 
библиотекой `razdel` будут восприняты как разделители слов (настраивается в файле `textparse.py`). 

Некоторые словари могут использовать питон-функции, которые должны располагаться в файле сайд-модуле, с названием 
полученным из имени словаря как `name_fmt.py`, для словаря с названием `name.fmt`. Например для `number.rex` в 
файле `number_rex.py`.


### dic. Коррекция текста простыми правилами поиска и замены.

*Область применения*: слово.

*Формат правила*: [*]поиск[*]=замена

*Пример*: $Ринуальд*=Ринуа`льд.

Поиск индексный. Вместо перебора всех правил, отбираются только те, которые имеют шанс быть применены. Поэтому 
скорость почти не зависит от размера словаря и чем он больше, тем больше выигрыш по сравнению с классическим способом.
Вплоть до 100 раз по сравнению с Балаболкой на словарях из сотен тысяч правил.

Маска `*` означает 0 и более количество символов. Маска может использоваться только по краям 
— `*оиск`, `поис*`, `*оис*`. В середине слова, `по*ск`, воспринимается как обычный символ/буква. 
В замене маску указывать не надо. 

Поиск может содержать только одно слово. Словосочетания обрабатываются словарем `dicx`

### dicx. Коррекция текста расширенными правилами поиска и замены. dic(eXtended)

*Область применения*: предложение

*Пример*: пра\*ило из \* слов\*=пра\*ило из \* слов


Дополнительно к правилам `dic`, строка поиска может содержать шаблон `*` как в середине слова, так и заменять
шаблоном целые слова. В строке поиска должно быть хоть одно слово без шаблона в его середине — ключ для индексного
поиска. Использование предварительной фильтрации правил по ключу, существенно, на порядки, сокращает количество
применяемых к тексту правил, а значит и скорость обработки.
Если ключ выделить невозможно, значит нужно использовать `rex` формат словаря. 

Маску по краям фразы поиска, в правой части дублировать не надо, аналогично правилам `dic`. 
Однако серединные шаблоны нуждаются в повторении.

### rex. Коррекция текста правилами на основе регулярных выражений.

*Область применения*: строка

*Формат правила*: regexp_поиска=строка_замены

*Пример*: (\d)\/(\d)=$1 / $2

`@` в начале строки замены (правая часть правила, после знака равно), указывает на использование функции,
возвращающей строку замены. Входящий параметр — [re.Match](https://docs.python.org/3/library/re.html#match-objects)
объект, содержащий найденный текст и его группы; возвращаемое значение — строка.
Например правило $\b([А-Я][-\w]+) ([IVXХ]+)\b=@dynasty вызовет функцию `def dynasty(match) -> str`.

#### rexw. Коррекция текста правилами на основе регулярных выражений. rex(Word)

*Область применения*: слово

*Пример*: $^[IVXLCDMХСМ]{2,}$=@roman2digit


Полностью копирует формат rex, кроме области применения — слово.
Основное назначение словаря, применение функций к отдельным словам. Полезно:
а) при использовании словаря в середине цепочки обработки, между словарями с областью применения "слово".
Не приходится собирать всю строку из слов, с последующим обратным разбиением. При использовании в начале и 
конце цепочки обработки, рациональнее использовать обычный rex-словарь.
б) удобнее задавать границы слов с помощью `^$`. Задание границ в обычных регулярках с помощью `\b`,
приводит к проблемам обработки составных слов содержащих дефис (Порт-Артур).


### extw. Коннектор для подключения внешних обработчиков (виртуальных словарей).

*Область применения*: слово

Правил не содержит. Может даже не содержать файла словаря, так как никаких данных он не содержит и не читает.
Функциональность опеределяется в сайд-модуле словаря. Два примера — коррекция по результату запроса в базу данных 
и сбор статистики, смотри в папке `doc\ext_examples`.

#### exts. Коннектор для подключения внешних обработчиков (виртуальных словарей).

*Область применения*: предложение

Аналогично `extw`, с другой областью применения. Например для обработки с помощью внешних библиотек типа 
`ruaccent` или `silero-stress`. Не забывайте при возврате заменять используемый внешней библиотекой символ 
ударения, на внутренний — \`.
